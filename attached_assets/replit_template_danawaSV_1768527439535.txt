0) 전제: 업데이트 타이밍 / 운영 리스크

다나와 판매실적은 KAMA/KAIDA 공식 자료 기반이고, 전월 실적 갱신 시점이 명시돼 있어요(국산: 매월 1일, 트림 상세는 25일 추가 / 수입: 15일경).

페이지 하단에 “동의 없이 무단복제 및 가공을 금함” 문구가 있습니다.

그래서 MVP는 이렇게 가는 걸 추천:

원문 데이터 “재배포”는 최소화(원시 테이블 그대로 저장/노출 X)

저장/노출은 파생 지표(급상승 점수, 증감률, 랭크 변화) 중심

각 모델은 다나와 원문 링크로 이동 버튼 제공


1) 데이터 가져오기: URL 패턴 2개만 알면 끝

다나와가 “모델별 판매실적”을 별도 화면으로 제공해요.

국산(모델별)
https://auto.danawa.com/auto/?Month=YYYY-MM-00&Nation=domestic&Tab=Model&Work=record

수입(모델별)
https://auto.danawa.com/auto/?Month=YYYY-MM-00&Nation=export&Tab=Model&Work=record

이 화면엔 이미 **판매량 / 점유율 / 전월대비(증감) / 전년대비(증감)**이 한 줄에 붙어있어요. (국산 모델 리스트 예시가 그대로 보입니다.)


2) “급상승 모델” 정의(스코어링) 추천

“급상승”을 단순히 **전월 증감(+대수)**만 보면 신차/프로모션에 너무 쏠려요. 아래 3개를 섞으면 레이더가 “그럴듯하게” 나옵니다.

필요한 값

sales: 이번달 판매량

prev_sales: 전월 판매량 (페이지에 같이 표기됨)

mom_abs = sales - prev_sales

mom_pct = mom_abs / max(prev_sales, 1)

rank_change: (전월 랭크 - 이번달 랭크) → 이 값은 전월 페이지도 한 번 더 가져와서 랭크를 매칭해야 함

필터(노이즈 제거)

sales >= 300 같은 최소 컷 (시장 상황에 따라 조정)

mom_abs > 0 인 것만 “급상승 후보”

스코어 예시(실무에서 무난)

score = 0.55 * z(mom_abs) + 0.35 * z(mom_pct) + 0.10 * z(rank_change)

z()는 후보들 내에서 표준화(평균 0, 표준편차 1)

prev_sales=0(신규/재집계)은 mom_pct가 폭발하니 상한 캡(예: mom_pct = min(mom_pct, 5))을 추천

결과 화면엔 “점수” 대신 사람이 이해하는 지표(▲대수, ▲%, 랭크↑)만 보여주고, 점수는 정렬용으로만 쓰면 좋아요.


3) 파이프라인: Replit이 ETL, Netlify가 대시보드
A. Replit(스케줄 잡) 역할

매일 1회(또는 1일/15일/25일 전후만) 실행

다나와에서 이번달 M과 전월 M-1 페이지(국산/수입)를 가져옴

모델별로 랭크/판매량 매칭 → mom_abs, mom_pct, rank_change, score 계산

결과를 DB(예: Supabase)에 radar_monthly 테이블로 저장

원문 링크도 함께 저장(대시보드에서 “원문 보기” 버튼 제공용)

Replit Scheduled Deployments는 “명령어를 정해두면 정해진 시간에 실행하고 종료”하는 잡에 딱 맞아요.
또한 스케줄에서 타임존을 선택할 수 있어 KST 기준 운영이 편합니다.

B. Netlify 역할

대시보드(정적 프론트) 배포

/api/radar?month=YYYY-MM-00&nation=domestic|export 같은 API Function으로 DB에서 읽어서 프론트에 전달

(원하면) Netlify Scheduled Functions로도 ETL 가능하지만, 30초 제한이 있어(크롤링+정제+DB쓰기까지 하면 빠듯해질 수 있음) MVP에선 Replit 쪽 ETL이 마음 편합니다.

참고로 Netlify Scheduled Functions는 cron을 UTC 기준으로 돌립니다.


4) 구현 디테일(핵심만)
4-1. “최신 월” 자동 판별

처음엔 단순하게:

(오늘이 1월이면) 최신 실적은 보통 **전월(12월)**일 가능성이 큼

더 안전하게 하려면, Work=record 페이지에서 “국산 모델 Top10” 같은 섹션에 찍히는 YYYY-MM-00을 파싱해서 최신 월을 잡는 방식이 좋아요(페이지에 그대로 노출됨).

4-2. 수입 페이지 주의점(트림 줄)

수입 페이지는 모델 한 줄 아래에 트림별 라인이 주르륵 붙는 구조예요.
→ 파서는 **“등급별 보기 … 모델명 … 판매량 … 전월대비”**가 있는 “랭크 시작 줄”만 잡고, 그 아래 트림 줄은 무시하면 됩니다.

4-3. 요청 빈도 / 캐시

월 1~2회 갱신 성격이 강하니(국산 1일/25일, 수입 15일경) 하루 1번이면 충분해요.

실패 대비로 “이미 DB에 같은 month/nation 데이터가 있으면 스킵” 같은 가드 넣기


5) 대시보드 화면(최소 구성)

상단: 월 선택(기본 최신), 토글(국산/수입)

카드 리스트(Top 20 급상승):

모델명 / 이번달 판매량

전월대비: +n대, +p%

랭크 변화: ↑k

버튼: “다나와 원문 보기”

필터:

최소 판매량 컷 슬라이더

“신규 진입(prev=0)” 제외/포함 체크